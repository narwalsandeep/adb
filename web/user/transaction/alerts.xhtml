<ui:composition template="/master/user-layout.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:define name="content">
		
		#{userBean.resetAlerts()}
		
		<div class="text text-success pull-right"> Available Balance : <strong>#{transactionBean.getCurrentAmount(loginBean.loggedInUser.id)} #{loginBean.loggedInUser.currency}</strong> </div>
		<br/><br/>
		<p>
			<h4>
				 Pending Money Requests
			</h4>
		</p>
		<strong><h:message styleClass="text text-danger" for="error" id="error"/></strong>

		<div class="panel panel-default">
		<div class="panel-heading"><small class="text text-primary"> Money requests by other users. NOTE: system will only approve if you have enough amount.</small>
</div>
		<h:dataTable value="#{transactionBean.findAllPendingRequestsByUser()}" var="tx"
					  styleClass="table table-condensed table-hover table-responsive">
			 <h:column>
				 <f:facet name="header">Request By (Name) </f:facet>
					 #{userBean.findOneById(tx.receiverId).getName()}
			 </h:column>
			 <h:column>
				 <f:facet name="header">Request By (Email) </f:facet>
					 #{userBean.findOneById(tx.receiverId).getEmail()}
			 </h:column>
			 <h:column>
				 <f:facet name="header">Amount</f:facet>
					 #{tx.amount}
			 </h:column>
			 <h:column>
				 <f:facet name="header"></f:facet>
				 <h:form>
					 <h:commandLink value="Approve" styleClass="btn btn-sm btn-success" action="#{transactionBean.approvePayment(tx)}"/>
				 </h:form>
			 </h:column>
			 <h:column>
				 <f:facet name="header"></f:facet>
				 <h:form>
					 <h:commandLink value="Reject" styleClass="btn btn-sm btn-danger" action="#{transactionBean.rejectPayment(tx)}"/>
				 </h:form>
			 </h:column>
			
		 </h:dataTable>
		 </div>


    </ui:define>
</ui:composition>
